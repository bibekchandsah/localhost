<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Canvas</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css">
  <link rel="stylesheet" href="canvas.css">
</head>
<body>
  <div class="cv-app">

    <!-- ── Toolbar ──────────────────────────────────────── -->
    <header class="cv-toolbar">

      <div class="cv-brand">
        <i class="fa-solid fa-paintbrush"></i>
        <span>Canvas</span>
      </div>

      <div class="cv-div"></div>

      <!-- Select tool -->
      <div class="cv-group">
        <button class="cv-tool" data-tool="select" title="Select / Move  [V]"><i class="fa-solid fa-arrow-pointer"></i></button>
      </div>

      <div class="cv-div"></div>

      <!-- Draw tools flyout -->
      <div class="cv-flyout" id="brushFlyout">
        <button class="cv-tool active" id="brushTrigger" data-tool="pencil" title="Pencil [P]">
          <i class="fa-solid fa-pencil"></i>
        </button>
        <div class="cv-flyout-menu">
          <button class="cv-tool active" data-tool="pencil"  title="Pencil  [P]"><i class="fa-solid fa-pencil"></i></button>
          <button class="cv-tool"        data-tool="brush"   title="Brush   [B]"><i class="fa-solid fa-paintbrush"></i></button>
          <button class="cv-tool"        data-tool="marker"  title="Marker  [M]"><i class="fa-solid fa-marker"></i></button>
          <button class="cv-tool"        data-tool="eraser"  title="Eraser  [E]"><i class="fa-solid fa-eraser"></i></button>
        </div>
      </div>

      <div class="cv-div"></div>

      <!-- Shape tools flyout -->
      <div class="cv-flyout" id="shapeFlyout">
        <button class="cv-tool" id="shapeTrigger" data-tool="rect" title="Rectangle [R]">
          <i class="fa-regular fa-square"></i>
        </button>
        <div class="cv-flyout-menu cv-shape-menu">
          <!-- ── Basic ── -->
          <button class="cv-tool" data-tool="line"         title="Line [L]"><i class="fa-solid fa-minus cv-diag"></i></button>
          <button class="cv-tool" data-tool="rect"         title="Rectangle [R]"><i class="fa-regular fa-square"></i></button>
          <button class="cv-tool" data-tool="circle"       title="Ellipse [C]"><i class="fa-regular fa-circle"></i></button>
          <button class="cv-tool" data-tool="polygon"      title="Polygon [G]"><i class="fa-solid fa-draw-polygon"></i></button>
          <button class="cv-tool" data-tool="arrow"        title="Arrow [A]"><i class="fa-solid fa-arrow-right"></i></button>
          <button class="cv-tool" data-tool="pill"         title="Pill / Stadium"><svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor"><rect x="2" y="5" width="12" height="6" rx="3"/></svg></button>
          <button class="cv-tool" data-tool="diamond"      title="Diamond"><svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor"><polygon points="8,1 15,8 8,15 1,8"/></svg></button>
          <button class="cv-tool" data-tool="parallelogram" title="Parallelogram"><svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor"><polygon points="4,1 16,1 12,15 0,15"/></svg></button>
          <!-- ── Special quads ── -->
          <button class="cv-tool" data-tool="trapezoid"    title="Trapezoid"><svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor"><polygon points="3,1 13,1 16,15 0,15"/></svg></button>
          <button class="cv-tool" data-tool="trapdown"     title="Trapezoid (wide top)"><svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor"><polygon points="0,1 16,1 13,15 3,15"/></svg></button>
          <button class="cv-tool" data-tool="cross"        title="Cross"><svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor"><path d="M6,0h4v6h6v4h-6v6h-4v-6H0V6h6z"/></svg></button>
          <button class="cv-tool" data-tool="frame"        title="Pincushion Frame"><svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor"><path d="M0,0 Q8,2 16,0 Q14,8 16,16 Q8,14 0,16 Q2,8 0,0z"/></svg></button>
          <!-- ── Organic ── -->
          <button class="cv-tool" data-tool="heart"        title="Heart"><i class="fa-solid fa-heart"></i></button>
          <button class="cv-tool" data-tool="cloud"        title="Cloud"><i class="fa-solid fa-cloud"></i></button>
          <button class="cv-tool" data-tool="speechbubble" title="Speech Bubble"><i class="fa-regular fa-comment"></i></button>
          <button class="cv-tool" data-tool="speechoval"   title="Speech Bubble (oval)"><i class="fa-regular fa-comment-dots"></i></button>
          <button class="cv-tool" data-tool="bookmark"     title="Bookmark"><i class="fa-solid fa-bookmark"></i></button>
          <button class="cv-tool" data-tool="ribbon"       title="Ribbon"><i class="fa-solid fa-ribbon"></i></button>
          <!-- ── Arch / D ── -->
          <button class="cv-tool" data-tool="arch"         title="Arch (door)"><svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor"><path d="M1,15 L1,7 A7,7 0 0,1 15,7 L15,15z"/></svg></button>
          <button class="cv-tool" data-tool="stadium"      title="D-shape"><svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor"><path d="M1,1 L15,1 L15,9 A7,5 0 0,1 1,9z"/></svg></button>
          <!-- ── Stars / Bursts (use Sides slider) ── -->
          <button class="cv-tool" data-tool="star"         title="Star — adjust Sides slider"><i class="fa-solid fa-star"></i></button>
          <button class="cv-tool" data-tool="starburst"    title="Starburst / Seal — adjust Sides slider"><i class="fa-solid fa-sun"></i></button>
          <!-- ── Polygon basics ── -->
          <button class="cv-tool" data-tool="triangle"     title="Triangle"><svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor"><polygon points="8,1 15,15 1,15"/></svg></button>
          <button class="cv-tool" data-tool="hexagon"      title="Hexagon"><svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor"><polygon points="8,1 14.9,4.5 14.9,11.5 8,15 1.1,11.5 1.1,4.5"/></svg></button>
        </div>
      </div>

      <div class="cv-div"></div>

      <!-- Text -->
      <div class="cv-group">
        <button class="cv-tool" data-tool="text" title="Text  [T]"><i class="fa-solid fa-font"></i></button>
      </div>

      <div class="cv-div"></div>

      <!-- Copy / Paste / Duplicate -->
      <div class="cv-group">
        <button class="cv-tool" id="copyBtn"      title="Copy  Ctrl+C"><i class="fa-regular fa-copy"></i></button>
        <button class="cv-tool" id="pasteBtn"     title="Paste  Ctrl+V"><i class="fa-solid fa-paste"></i></button>
        <button class="cv-tool" id="duplicateBtn" title="Duplicate  Ctrl+D"><i class="fa-solid fa-clone"></i></button>
      </div>

      <div class="cv-div"></div>

      <!-- Layer order flyout -->
      <!-- Lock / Unlock -->
      <button class="cv-tool" id="lockBtn" title="Lock / Unlock  Ctrl+L" disabled>
        <i class="fa-solid fa-lock"></i>
      </button>

      <div class="cv-flyout" id="layerFlyout">
        <button class="cv-tool" id="layerTrigger" title="Layer order" disabled>
          <i class="fa-solid fa-layer-group"></i>
        </button>
        <div class="cv-flyout-menu cv-layer-menu">
          <button class="cv-tool cv-layer-item" id="bringFrontBtn"   title="Bring to Front  Ctrl+Shift+]"><i class="fa-solid fa-angles-up"></i><span class="cv-layer-name">Bring to Front</span><kbd>Ctrl+Shift+]</kbd></button>
          <button class="cv-tool cv-layer-item" id="bringForwardBtn" title="Bring Forward  Ctrl+]"><i class="fa-solid fa-angle-up"></i><span class="cv-layer-name">Bring Forward</span><kbd>Ctrl+]</kbd></button>
          <button class="cv-tool cv-layer-item" id="sendBackwardBtn" title="Send Backward  Ctrl+["><i class="fa-solid fa-angle-down"></i><span class="cv-layer-name">Send Backward</span><kbd>Ctrl+[</kbd></button>
          <button class="cv-tool cv-layer-item" id="sendBackBtn"     title="Send to Back  Ctrl+Shift+["><i class="fa-solid fa-angles-down"></i><span class="cv-layer-name">Send to Back</span><kbd>Ctrl+Shift+[</kbd></button>
        </div>
      </div>

      <div class="cv-div"></div>

      <!-- Group / Ungroup -->
      <div class="cv-group">
        <button class="cv-tool" id="groupBtn"   title="Group selected  Ctrl+G"         disabled><i class="fa-solid fa-object-group"></i></button>
        <button class="cv-tool" id="ungroupBtn" title="Ungroup  Ctrl+Shift+G"          disabled><i class="fa-solid fa-object-ungroup"></i></button>
        
        <label class="cv-fill-lbl" title="Fill shapes">
          <input type="checkbox" id="fillToggle">
          <span>Fill</span>
        </label>
      </div>

      <div class="cv-div"></div>

      <!-- Color picker + palette -->
      <div class="cv-color-wrap">
        <label class="cv-color-btn" title="Pick color (click)">
          <div class="cv-color-preview" id="colorPreview"></div>
          <input type="color" id="colorPicker" value="#e74c3c">
        </label>
        <div class="cv-palette-flyout" id="paletteFlyout">
          <div class="cv-palette" id="palette"></div>
          <div class="cv-palette-menu" id="paletteMenu"></div>
        </div>
      </div>

      <div class="cv-div"></div>

      <!-- Background color + visibility -->
      <div class="cv-group">
        <span class="cv-lbl" style="padding:0 2px">Bg</span>
        <label class="cv-color-btn" title="Canvas background color" id="bgColorBtn">
          <div class="cv-color-preview" id="bgColorPreview"></div>
          <input type="color" id="bgColorPicker" value="#252525">
        </label>
        <button class="cv-tool active" id="bgToggle" title="Show / hide background layer">
          <i class="fa-solid fa-eye"></i>
        </button>
      </div>

      <div class="cv-div"></div>

      <!-- Size / Opacity / Fill — hover reveals Rounding & Sides -->
      <div class="cv-props-flyout" id="propsFlyout">
        <!-- Always visible -->
        <div class="cv-props-strip">
          <div class="cv-prop">
            <span class="cv-lbl">Size&nbsp;<b id="sizeVal">5</b></span>
            <input type="range" class="cv-range" id="sizeRange" min="1" max="80" value="5">
          </div>
          <div class="cv-prop">
            <span class="cv-lbl">Opacity&nbsp;<b id="opacityVal">100%</b></span>
            <input type="range" class="cv-range" id="opacityRange" min="10" max="100" value="100">
          </div>
          <!-- <label class="cv-fill-lbl" title="Fill shapes">
            <input type="checkbox" id="fillToggle">
            <span>Fill</span>
          </label> -->
        </div>
        <!-- Hover menu -->
        <div class="cv-props-menu" id="propsMenu">
          <div class="cv-prop">
            <span class="cv-lbl">Rounding&nbsp;<b id="cornerRoundingVal">0</b></span>
            <input type="range" class="cv-range" id="cornerRoundingRange" min="0" max="100" value="0">
          </div>
          <div class="cv-prop">
            <span class="cv-lbl">Sides&nbsp;<b id="sidesVal">3</b></span>
            <input type="range" class="cv-range" id="sidesRange" min="3" max="20" value="3">
          </div>
        </div>
      </div>

      <div class="cv-div"></div>

      <!-- History & actions -->
      <div class="cv-group">
        <button class="cv-tool" id="undoBtn"     title="Undo  Ctrl+Z" disabled><i class="fa-solid fa-rotate-left"></i></button>
        <button class="cv-tool" id="redoBtn"     title="Redo  Ctrl+Y" disabled><i class="fa-solid fa-rotate-right"></i></button>
        <button class="cv-tool" id="clearBtn"    title="Clear canvas"><i class="fa-solid fa-trash-can"></i></button>
        <button class="cv-tool" id="downloadBtn" title="Save PNG  Ctrl+S"><i class="fa-solid fa-download"></i></button>
      </div>

      <div class="cv-spacer"></div>

      <button class="cv-tool cv-close-btn" id="closeBtn" title="Close canvas">
        <i class="fa-solid fa-xmark"></i>
      </button>
    </header>

    <!-- ── Canvas area ──────────────────────────────────── -->
    <div class="cv-canvas-area" id="cvArea">
      <canvas id="mainCanvas"></canvas>
      <canvas id="previewCanvas"></canvas>
      <!-- Floating text input -->
      <div id="textOverlay" class="cv-text-overlay">
        <textarea id="textInput" class="cv-text-input" rows="2" placeholder="Type…"></textarea>
      </div>
    </div>

    <!-- ── Page strip ────────────────────────────────────── -->
    <div class="cv-pages-bar" id="pagesBar">
      <div class="cv-pages-scroll" id="pagesScroll">
        <!-- page thumbnails injected by JS -->
      </div>
      <button class="cv-page-add" id="pageAddBtn" title="Add new page">
        <i class="fa-solid fa-plus"></i>
      </button>
    </div>

  </div>

  <!-- ── Page-deleted undo toast ───────────────────────── -->
  <div id="cvUndoToast" class="cv-undo-toast">
    <span class="cv-undo-toast-msg"></span>
    <button class="cv-undo-toast-btn">Undo</button>
    <div class="cv-undo-toast-bar"></div>
  </div>

  <script src="canvas.js"></script>
</body>
</html>
